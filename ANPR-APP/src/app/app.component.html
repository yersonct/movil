<ion-app>
  <ion-split-pane contentId="main-content" when="(min-width: 992px)">
    <ion-menu contentId="main-content" type="overlay" class="bubble-menu" menuId="main-menu"  [disabled]="isPublic"
      [swipeGesture]="!isPublic">
      <ion-content class="menu-content">

        <!-- Forma orgánica de fondo -->
        <!-- Fondo con forma orgánica -->
<div class="bubble-background">
  <svg class="bubble-svg" viewBox="0 0 320 240" preserveAspectRatio="none" aria-hidden="true">
    <defs>
      <linearGradient id="bubbleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#4ecdc4"/>
        <stop offset="55%" stop-color="#44a08d"/>
        <stop offset="100%" stop-color="#00bcd4"/>
      </linearGradient>
      <!-- Suaviza bordes -->
      <filter id="soften" x="-10%" y="-10%" width="120%" height="120%">
        <feGaussianBlur in="SourceGraphic" stdDeviation="0.6"/>
      </filter>
    </defs>

    <!-- OLA con “panza” hacia la derecha (como el mockup) -->
    <path filter="url(#soften)" fill="url(#bubbleGradient)"
      d="M0,0
         H380
         C250,78 230,70 205,72
         C165,75 150,98 120,110
         C92,121 63,118 40,125
         C20,131 8,142 0,156
         Z"/>
  </svg>
</div>


        <!-- Contenido del menú -->
        <div class="menu-wrapper">

          <!-- Header con perfil -->
          <div class="profile-header">
            <button class="close-btn" (click)="closeMenu()">
              <ion-icon name="close-outline"></ion-icon>
            </button>

            <div class="profile-info">
              <div class="avatar-wrapper">
                <div class="user-avatar">
                <p>{{ getInitials() }}</p>
                </div>


              </div>

              <div class="user-details">
                <h2 class="user-name">{{ username || 'Anónimo' }}</h2>
                <ng-container *ngIf="roles?.length; else noRoles">
                  <p class="user-role">{{ roles[0] }}</p>
                </ng-container>
                <ng-template #noRoles>
                  <p class="user-role">Sin roles</p>
                </ng-template>
              </div>
            </div>
          </div>
          <!-- Spacer para encajar el primer item justo bajo la curva -->
<div class="curve-spacer"></div>

          <!-- Lista de navegación -->
          <div class="navigation-section">
            <ion-list class="bubble-nav-list">

              <ng-container *ngFor="let p of appPages; let i = index">
                <ion-menu-toggle auto-hide="false">
                  <div class="nav-item-wrapper"
                       [class.active]="isActiveRoute(p.url)"
                       (click)="navigateToPage(p.url)">

                    <div class="nav-item-content">
                      <div class="icon-container">

                        <ion-icon [name]="p.icon + '-sharp'" class="nav-icon"></ion-icon>
                      </div>
                      <span class="nav-text">{{ p.title }}</span>
                    </div>

                    <!-- Indicador de selección -->
                    <div class="selection-indicator" *ngIf="isActiveRoute(p.url)"></div>
                  </div>
                </ion-menu-toggle>
              </ng-container>



            </ion-list>
          </div>

        </div>
      </ion-content>
    </ion-menu>
    <ion-router-outlet id="main-content"></ion-router-outlet>
  </ion-split-pane>
</ion-app>
